
@testset "no intercept model" begin
    x = [-5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0]
    y = [32.76095293186829, 32.114646881731815, 30.482249790567508, 30.172132123809526, 28.858546806301607, 27.55525364876047, 26.748316399220183, 25.47632057519211, 24.178757213602406, 23.115113146604088, 21.67768685139419, 20.667430892918777, 19.25030326250073, 17.969338480523586, 16.92778066296735, 16.01093498430364, 14.972217418295738, 14.129273625410654, 12.528548495622791, 11.995655292690893, 10.437691863433523, 9.04875056404323, 8.352545547062054, 6.595027421481294, 5.769353744384407, 4.656766397706274, 3.2769464299313293, 2.557398138612538, 1.8697655690559674, 0.1758423094007262, -1.1812180900645513, -2.4595328718334226, -3.224902727206241, -4.52850811714283, -5.620262454732497, -6.65705617649476, -8.109350054557144, -8.964028166630365, -9.764063784932889, -11.49260887582183, -12.144819717782108, -13.843175083307838, -14.603379688823846, -15.335111221096993, -16.28627855774275, -17.73382957392828, -19.156926371425502, -20.641255379884615, -21.17362575264, -22.5708673184868, -23.072613984429083]
    df = DataFrame(x=x, y=y)
    lrnoint = regress(@formula(y ~ 0 + x), df, req_stats=[:default, :aic, :vif])
    @test isapprox(0.9252939081, lrnoint.R2)
    @test isapprox(0.9237997863, lrnoint.ADJR2)
    @test isapprox(160.90768623, lrnoint.AIC)
    @test isapprox([0.], lrnoint.VIF)

    results = predict_in_sample(lrnoint, df, Î±=0.05, req_stats=["default", "rstudent"]) 
    @test isapprox([28.385804339677044, 27.25037216608996, 26.114939992502876, 24.9795078189158, 23.84407564532872, 22.708643471741635, 21.57321129815455, 20.43777912456747, 19.30234695098039, 18.16691477739331, 17.031482603806225, 15.896050430219143, 14.760618256632062, 13.62518608304498, 12.4897539094579, 11.354321735870817, 10.218889562283735, 9.083457388696655, 7.948025215109571, 6.81259304152249, 5.677160867935409, 4.541728694348327, 3.406296520761245, 2.2708643471741636, 1.1354321735870818, 0.0, -1.1354321735870818, -2.2708643471741636, -3.406296520761245, -4.541728694348327, -5.677160867935409, -6.81259304152249, -7.948025215109571, -9.083457388696655, -10.218889562283735, -11.354321735870817, -12.4897539094579, -13.62518608304498, -14.760618256632062, -15.896050430219143, -17.031482603806225, -18.16691477739331, -19.30234695098039, -20.43777912456747, -21.57321129815455, -22.708643471741635, -23.84407564532872, -24.9795078189158, -26.114939992502876, -27.25037216608996, -28.385804339677044] 
            , results.predicted)
    @test isapprox([0.938033258871313, 1.0426179367896207, 0.9319648731276958, 1.1097378448312425, 1.0685340559242513, 1.0299419326232258, 1.0993609703148552, 1.0677740527805426, 1.0309373482675432, 1.0448144116724511, 0.978326230602586, 1.0038487427946268, 0.9422793707140289, 0.9101464457061582, 0.9291611309816967, 0.9748389070719975, 0.9946108960924838, 1.0563303532318353, 0.9563424123040439, 1.0843302339300107, 0.993564396349128, 0.9392838550370636, 1.032388388246509, 0.9000336054567951, 0.9655586062937045, 0.97036522335683, 0.9185810103197727, 1.007013102837162, 1.1028816259631355, 0.9840106274248026, 0.9373227029099432, 0.9074862070811145, 0.9866973636129569, 0.9515650780179017, 0.9616191528659762, 0.9835165279774034, 0.9168886277207625, 0.9778135787709513, 1.0509330791271387, 0.9250288747899885, 1.0300270784500691, 0.910564302144073, 0.992654638302146, 1.0816862270131862, 1.1237223658970572, 1.0578001520839455, 0.9973186697257519, 0.9236477076314706, 1.0570827343881202, 1.0021858611232244, 1.1440369678715858]
            , results.rstudent)

    y = [3.547744106900422, 9.972950249405148, 16.471345464154027, 22.46768807351274, 20.369933318011807, 21.18590757820348, 29.962620198209024, 30.684400502954748, 29.28429078492597, 34.272759386588824, 33.05504692986838, 45.09273876302829, 45.28374262744938, 54.54563960566191, 46.86173948296966, 46.85926120310666, 67.54337216713414, 66.0400205145086, 64.77001443647681, 63.98759256558095, 15.016939388490687, 12.380885701920008, 10.221963402745288, 24.826987790646672, 22.231511892187548, 18.05125492502642, 21.809661866284717, 28.533306224702308, 24.70476800009685, 39.592181057942916, 37.425282624708906, 33.89372811236659, 44.07442335927311, 42.61943719318272, 52.32531447897055, 44.12096163880534, 49.19965880584543, 52.304114239221036, 59.79488104919937, 65.00419916894333, 10.978506745605673, 12.944637189081874, 16.96525561080181, 15.93489355798633, 33.559135307088305, 28.887571687420433, 28.296418324622593, 32.2405215537489, 31.466024917490223, 37.78855308849255, 48.09725215994402, 40.70190542438069, 43.2525436240948, 44.75159242105558, 52.553066965996074, 53.265851121437095, 60.092700204726015, 62.78014347092756, 69.07895282754228, 74.27890668517966, 10.57283140105129, 7.290600131361426, 16.10299402050687, 14.428954773831242, 22.418180226673464, 28.21022852582732, 29.60436622143203, 33.648588929669636, 37.451930576147994, 43.85548900583812, 41.44168340404242, 43.48815266671309, 54.72835160956764, 53.55177468229062, 50.62088969800169, 50.863408563713335, 47.40251347184729, 64.29413401802115, 64.20687412126479, 73.66653216085827, 15.820723594639162, 21.973463928234743, 23.804440715385162, 15.139822408433913, 30.015089890369985, 28.08454394421385, 33.041880065463566, 28.49429418531324, 38.33763660905526, 34.503176013521724, 48.748946870573235, 45.45351516824085, 53.522908096188765, 45.95216131836423, 63.13018379633756, 63.4236036208151, 65.28265579397677, 55.43500146374922, 76.50187470137375, 67.22421998359037, 19.289152114521762, 27.63557010588222, 17.700031078096686, 25.462368278660957, 22.94613580060685, 36.19731649621813, 35.22216995579936, 25.526434727578838, 45.882864925557726, 38.71433797181679, 50.617762276434554, 41.96951039650285, 52.265123328453214, 45.383991138243765, 62.7923270665056, 64.40670612696276, 74.89775274405821, 72.89056716347118, 66.37071343209973, 76.32913721410918, 29.923781174452596, 16.465832617450324, 30.530915733275403, 30.512411156491954, 28.04012351007911, 26.315140074869376, 37.18491928428231, 41.958551085353626, 48.370736387628895, 49.419917216561835, 48.67296268029715, 55.484477112881166, 51.120639229597025, 54.797092949987224, 61.92608065418044, 69.79495109420618, 64.43521939892794, 74.35280205157255, 77.22355341160723, 68.90654715174155, 10.87752158238755, 20.25006748725279, 31.71957876614495, 31.42898857400639, 32.505052996368256, 34.1225641368903, 35.66496173153403, 31.76371648643483, 42.97107454773545, 47.41827763710622]
    x2 = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]
    x3 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    df = DataFrame(y=y, x2=x2, x3=x3)

    lrnoint = regress(@formula(y ~ 0 + x2 +x3), df, req_stats=["default", "pcorr1", "pcorr2", "scorr1", "scorr2", "vif"])
    @test isapprox([207017.27329467665, 84364.93565847247], lrnoint.Type1SS)
    @test isapprox([6502.255171530228, 84364.93565847244], lrnoint.Type2SS)
    @test isapprox([0.9814816505541067, 0.9557504161506739], lrnoint.pcorr1) 
    @test isapprox([0.6247239646866073, 0.9557504161506739], lrnoint.pcorr2)
    @test isapprox([0.7010686580206047, 0.28570375449728647], lrnoint.scorr1)
    @test isapprox([0.02202003356851988, 0.28570375449728636], lrnoint.scorr2)
    @test isapprox([1.0099808403511108, 1.0099808403511117], lrnoint.VIF)
    @test isapprox(0.9867724125178912, lrnoint.R2)
    @test isapprox(0.9865936613357005, lrnoint.ADJR2)
end

@testset "no intercept weighted regression" begin 
        tw = [
            2.3  7.4  0.058 
            3.0  7.6  0.073 
            2.9  8.2  0.114 
            4.8  9.0  0.144 
            1.3 10.4  0.151 
            3.6 11.7  0.119 
            2.3 11.7  0.119 
            4.6 11.8  0.114 
            3.0 12.4  0.073 
            5.4 12.9  0.035 
            6.4 14.0  0
        ] # data from https://blogs.sas.com/content/iml/2016/10/05/weighted-regression.html
        
        df = DataFrame(tw, [:y,:x,:w])
        f = @formula(y ~ 0 + x)
        lm = regress(f, df, weights="w")
    
        @test isapprox([0.3056575637534476], lm.coefs)
        @test isapprox(0.8626294380695502, lm.R2)
        @test isapprox(0.8473660422995002, lm.ADJR2)
        @test isapprox([0.040658241629241754], lm.stderrors)
        @test isapprox([3.6247531175150984e-5], lm.p_values)
    
end
    
