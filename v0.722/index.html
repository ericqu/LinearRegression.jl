<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · LinearRegression.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>LinearRegression.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Content"><span>Content</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="basic_tutorial/">Basic</a></li><li><a class="tocitem" href="multi_tutorial/">Multiple regression</a></li><li><a class="tocitem" href="weighted_regression_tutorial/">Weighted regression</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ericqu/LinearRegression.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="LinearRegression.jl-Documentation"><a class="docs-heading-anchor" href="#LinearRegression.jl-Documentation">LinearRegression.jl Documentation</a><a id="LinearRegression.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#LinearRegression.jl-Documentation" title="Permalink"></a></h1><p>LinearRegression.jl implements linear regression using the least-squares algorithm (relying on the sweep operator). This package is in the alpha stage. Hence it is likely that some bugs exist. Furthermore, the API might change in future versions.</p><p>The usage aims to be straightforward, a call to <code>regress</code> to build a linear regression model, and a call to <code>predict_in_sample</code> to predict data using the built linear regression model. When predicting on data not present during the regression, use the <code>predict_out_of_sample</code> function as this does not require a response value (consequently, statistics that need a response, as the residuals, are not available.)</p><p>The regress call will compute some statistics about the fitted model in addition to the coefficients. The statistics computed depend on the value of the <code>req_stats</code> argument.  The prediction functions compute predicted values together with some statistics. Like for the regress calls, the statistics computed depend on the value of the <code>req_stats</code> argument.</p><h3 id="Statistics-related-to-the-regression-(the-fitting)"><a class="docs-heading-anchor" href="#Statistics-related-to-the-regression-(the-fitting)">Statistics related to the regression (the fitting)</a><a id="Statistics-related-to-the-regression-(the-fitting)-1"></a><a class="docs-heading-anchor-permalink" href="#Statistics-related-to-the-regression-(the-fitting)" title="Permalink"></a></h3><p>Fitting the model generates some statistics dependent on the <code>req_stats</code> argument of the <code>regress</code> function.</p><ul><li><span>$n$</span>, <span>$p$</span>, <code>&quot;coefs&quot;</code> and <code>&quot;see&quot;</code> are always computed</li><li><code>&quot;mse&quot;</code>, <code>&quot;sst&quot;</code>, <code>&quot;rmse&quot;</code>, <code>&quot;aic&quot;</code>,  <code>&quot;sigma&quot;</code>, <code>&quot;t_statistic&quot;</code>, <code>&quot;vif&quot;</code>, <code>&quot;r2&quot;</code>, <code>&quot;adjr2&quot;</code>, <code>&quot;stderror&quot;</code>, <code>&quot;t_values&quot;</code>, <code>&quot;p_values&quot;</code>, <code>&quot;ci&quot;</code>,  are computed upon request.<ul><li>some diagnostics can be requested as well. Here is the full list as Symbols <code>[:diag_normality, :diag_ks, :diag_ad, :diag_jb, :diag_heteroskedasticity, :diag_white, :diag_bp ]</code>, <code>&quot;diag_normality&quot;</code> is a shortcut for <code>[:diag_ks, :diag_ad, :diag_jb]</code> and <code>:diag_heteroskedasticity</code> is a shortcut for <code>[:diag_white, :diag_bp]</code>. </li></ul></li><li>&quot;default&quot;, includes the mandatory stats, and some of the optional statistics here as Symbols: <code>[:coefs, :sse, :mse, :sst, :rmse, :sigma, :t_statistic, :r2, :adjr2, :stderror, :t_values, :p_values, :ci]</code></li><li><code>&quot;all&quot;</code> includes all availble statistics</li><li><code>&quot;none&quot;</code> include only the mandatory statistics</li></ul><p>The meaning for these statistics is given below.</p><h4 id="Number-of-observations-and-variables"><a class="docs-heading-anchor" href="#Number-of-observations-and-variables">Number of observations and variables</a><a id="Number-of-observations-and-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Number-of-observations-and-variables" title="Permalink"></a></h4><p>The number of observations <span>$n$</span> used to fit the model.</p><p>The number of independent variables <span>$p$</span> used in the model.</p><h4 id="Total-Sum-of-Squares"><a class="docs-heading-anchor" href="#Total-Sum-of-Squares">Total Sum of Squares</a><a id="Total-Sum-of-Squares-1"></a><a class="docs-heading-anchor-permalink" href="#Total-Sum-of-Squares" title="Permalink"></a></h4><p>The Total Sum of Squares (SST) is calculated but not presented to the user. In case of model with intercept the SST is computed with the following:</p><p class="math-container">\[\mathrm{SST}=\sum_{i=1}^{n}\left(y_{i}-\bar{y}\right)^2\]</p><p>And when there is no intercept with the following: </p><p class="math-container">\[\mathrm{SST}=\sum_{i=1}^{n} y_{i}^2\]</p><h4 id="Error-Sum-of-Squares"><a class="docs-heading-anchor" href="#Error-Sum-of-Squares">Error Sum of Squares</a><a id="Error-Sum-of-Squares-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Sum-of-Squares" title="Permalink"></a></h4><p>The Error Sum of Squares (or SSE) also known as Residual Sum of Square (RSS). This package uses the sweep operator (Goodnight, J. (1979). &quot;A Tutorial on the SWEEP Operator.&quot; The American Statistician.) to compute the SSE.</p><h4 id="Mean-Squared-Error"><a class="docs-heading-anchor" href="#Mean-Squared-Error">Mean Squared Error</a><a id="Mean-Squared-Error-1"></a><a class="docs-heading-anchor-permalink" href="#Mean-Squared-Error" title="Permalink"></a></h4><p>The Mean Squared Error (MSE) is calculated as </p><p class="math-container">\[\mathrm{MSE} = \displaystyle{\frac{{\mathrm{SSE}}}{{n - p}}}\]</p><p>The Root Mean Squared Error (RMSE) is calculated as </p><p class="math-container">\[\mathrm{RMSE} = \sqrt{\mathrm{MSE}}\]</p><p>The MSE is the estimator of σ̂² unless at least one robust covariance estimator is requested.</p><h4 id="R-and-Adjusted-R"><a class="docs-heading-anchor" href="#R-and-Adjusted-R">R² and Adjusted R²</a><a id="R-and-Adjusted-R-1"></a><a class="docs-heading-anchor-permalink" href="#R-and-Adjusted-R" title="Permalink"></a></h4><p>The R² (R2 or R-squared) see (https://en.wikipedia.org/wiki/Coefficient<em>of</em>determination) is calculated with the following formula: </p><p class="math-container">\[\mathrm{R}^2 = 1 - \displaystyle{\frac{{\mathrm{SSE}}}{{\mathrm{SST}}}}\]</p><p>The Adjusted R² (ADJR2) is computed with the following formulas:</p><p>when it is a model with an intercept:</p><p class="math-container">\[\mathrm{ADJR}^2 = 1 - \displaystyle \frac{(n-1)(1-\mathrm{R}^2)}{n-p}\]</p><p>And when there is no intercept:</p><p class="math-container">\[\mathrm{ADJR}^2 = 1 - \displaystyle \frac{(n)(1-\mathrm{R}^2)}{n-p}\]</p><h4 id="Akaike-information-criterion"><a class="docs-heading-anchor" href="#Akaike-information-criterion">Akaike information criterion</a><a id="Akaike-information-criterion-1"></a><a class="docs-heading-anchor-permalink" href="#Akaike-information-criterion" title="Permalink"></a></h4><p>The Akaike information criterion is calculated with the Linear Regression specific formula:</p><p class="math-container">\[\mathrm{AIC} = \displaystyle n \ln \left( \frac{\mathrm{SSE}}{n} \right) + 2p\]</p><h4 id="t_statistic-and-confidence-interval"><a class="docs-heading-anchor" href="#t_statistic-and-confidence-interval">t_statistic and confidence interval</a><a id="t_statistic-and-confidence-interval-1"></a><a class="docs-heading-anchor-permalink" href="#t_statistic-and-confidence-interval" title="Permalink"></a></h4><p>The t_statistic is computed by using the inverse cumulative t_distribution (with <code>quantile()</code>) with parameter (<span>$n - p$</span>) at <span>$1 - \frac{α}{2}$</span>. </p><p>The standard errors of the coefficients are calculated by multiplying the Sigma (estimated by the MSE) with the pseudo inverse matrix (resulting from the sweep operator), out of which the square root of the diagonal elements are extracted.</p><p>The t-values are calculated as the coefficients divided by their standard deviation.</p><p>The upper bound of the confidence interval for each coefficient is calculated as the coeffiecent + coefficient&#39;s standard error * t_statistic.</p><p>The lower bound of the confidence interval for each coefficient is calculated as the coeffiecent - coefficient&#39;s standard error * t_statistic.</p><h4 id="p-values"><a class="docs-heading-anchor" href="#p-values">p-values</a><a id="p-values-1"></a><a class="docs-heading-anchor-permalink" href="#p-values" title="Permalink"></a></h4><p>The p-values are computed using the F Distribution, the degree of freedom for each coefficent.</p><h4 id="Variance-inflation-factor"><a class="docs-heading-anchor" href="#Variance-inflation-factor">Variance inflation factor</a><a id="Variance-inflation-factor-1"></a><a class="docs-heading-anchor-permalink" href="#Variance-inflation-factor" title="Permalink"></a></h4><p>Variance inflation factor (VIF) is calculated by taking the  diagonal elements of the inverse of the correlation matrix formed by the independent variables.</p><h3 id="Robust-covariance-estimators"><a class="docs-heading-anchor" href="#Robust-covariance-estimators">Robust covariance estimators</a><a id="Robust-covariance-estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Robust-covariance-estimators" title="Permalink"></a></h3><p>Robust Covariance estimator can be requested through the <code>cov</code> argument of the <code>regress</code> function. The options are (as Symbols):</p><ul><li><code>:white</code>: Heteroscedasticity </li><li><code>:hc0</code>: Heteroscedasticity</li><li><code>:hc1</code>: Heteroscedasticity)</li><li><code>:hc2</code>: Heteroscedasticity)</li><li><code>:hc3</code>: Heteroscedasticity)</li><li><code>:nw</code>: HAC (Heteroskedasticity and Autocorrelation Consistent estimator)</li></ul><h4 id="Heteroscedasticity-estimators"><a class="docs-heading-anchor" href="#Heteroscedasticity-estimators">Heteroscedasticity estimators</a><a id="Heteroscedasticity-estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Heteroscedasticity-estimators" title="Permalink"></a></h4><p>The user can select estimators from above list. If the user select <code>:white</code> as an estimator then HC3 will be selected for a small size (n &lt;= 250) otherwise HC0 will be selected. (see &quot;Using Heteroscedasticity Consitent Standard Errors in the Linear Regression Model&quot; J. Scott Long and Laurie H. Ervin (1998-2000)). If another estimator is requested it is provided. A list of estimator can be requested as in for instance <code>cov=[:hc2, hc3]</code>. Comprehensive descriptions of the estimators and their applications shoudl in found in a text book, here only a brief description of the implementation is provided. </p><h5 id="HC0"><a class="docs-heading-anchor" href="#HC0">HC0</a><a id="HC0-1"></a><a class="docs-heading-anchor-permalink" href="#HC0" title="Permalink"></a></h5><p>Having InvMat the pseudo inverse resulting from the sweep operator. And having <span>$xe$</span> being the matrix of the independent variables times the residuals. Then HC0 is calculated as:</p><p class="math-container">\[\textup{HC0} = \sqrt{diag(\textup{InvMat } \textup{xe}&#39; \textup{xe} \textup{ InvMat})}\]</p><h5 id="HC1"><a class="docs-heading-anchor" href="#HC1">HC1</a><a id="HC1-1"></a><a class="docs-heading-anchor-permalink" href="#HC1" title="Permalink"></a></h5><p>Having n being the number of observations and p the number of variables. Then HC1 is calculated as:</p><p class="math-container">\[\textup{HC1} = \sqrt{diag(\textup{InvMat } \textup{xe}&#39; \textup{xe} \textup{ InvMat } \frac{n}{n-p})}\]</p><h5 id="HC2"><a class="docs-heading-anchor" href="#HC2">HC2</a><a id="HC2-1"></a><a class="docs-heading-anchor-permalink" href="#HC2" title="Permalink"></a></h5><p>The leverage or hat matrix is calculated as:</p><p class="math-container">\[\textup{H} = \textup{X} (\textup{X&#39;X})^{-1}\textup{X&#39;}\]</p><p><span>$xe$</span> is scaled by <span>$\frac{1}{1 - H}$</span> then </p><p class="math-container">\[\textup{HC2} = \sqrt{diag(\textup{InvMat } \textup{xe}&#39; \textup{xe} \textup{ InvMat } )}\]</p><h5 id="HC3"><a class="docs-heading-anchor" href="#HC3">HC3</a><a id="HC3-1"></a><a class="docs-heading-anchor-permalink" href="#HC3" title="Permalink"></a></h5><p><span>$xe$</span> is scaled by <span>$\frac{1}{{\left( 1 - H \right)^2}}$</span> then </p><p class="math-container">\[\textup{HC3} = \sqrt{diag(\textup{InvMat } \textup{xe}&#39; \textup{xe} \textup{ InvMat } )}\]</p><h4 id="Heteroskedasticity-and-autocorrelation-consistent-estimator-(HAC)"><a class="docs-heading-anchor" href="#Heteroskedasticity-and-autocorrelation-consistent-estimator-(HAC)">Heteroskedasticity and autocorrelation consistent estimator (HAC)</a><a id="Heteroskedasticity-and-autocorrelation-consistent-estimator-(HAC)-1"></a><a class="docs-heading-anchor-permalink" href="#Heteroskedasticity-and-autocorrelation-consistent-estimator-(HAC)" title="Permalink"></a></h4><p>Newey-West estimator calculation is not documented yet. See <a href="https://github.com/mcreel/Econometrics/blob/508aee681ca42ff1f361fd48cd64de6565ece221/src/NP/NeweyWest.jl">reference implementation</a> <a href="https://github.com/ericqu/LinearRegression.jl/blob/docu/src/newey_west.jl">current implementation</a> for details.</p><h3 id="Statistics-related-to-the-prediction"><a class="docs-heading-anchor" href="#Statistics-related-to-the-prediction">Statistics related to the prediction</a><a id="Statistics-related-to-the-prediction-1"></a><a class="docs-heading-anchor-permalink" href="#Statistics-related-to-the-prediction" title="Permalink"></a></h3><p>Predicting values using independent variables and a model will generate predicted values and some additional statistics dependent on the value of the <code>req_stats</code> argument of the <code>predict*</code> functions. Here is a list of the available statistics: [:predicted, :residuals, :leverage, :stdp, :stdi, :stdr, :student, :rstudent, :lcli, :ucli, :lclp, :uclp, :press, :cooksd]</p><h4 id="Predicted"><a class="docs-heading-anchor" href="#Predicted">Predicted</a><a id="Predicted-1"></a><a class="docs-heading-anchor-permalink" href="#Predicted" title="Permalink"></a></h4><p>The predicted value is the sum of the dependant variable(s) multiplied by the coefficients from the regression and the intercept (if the model has one). The predicted value is also known as the Y-hat.</p><h4 id="Residuals"><a class="docs-heading-anchor" href="#Residuals">Residuals</a><a id="Residuals-1"></a><a class="docs-heading-anchor-permalink" href="#Residuals" title="Permalink"></a></h4><p>The residuals are here defined as the known responses variables minus the predicted values.</p><h4 id="Leverage"><a class="docs-heading-anchor" href="#Leverage">Leverage</a><a id="Leverage-1"></a><a class="docs-heading-anchor-permalink" href="#Leverage" title="Permalink"></a></h4><p>The leverage for the i-th independent observation x_i when it is not a weighted regression is calculated as:</p><p class="math-container">\[\mathrm{h_i} = \mathrm{x_i&#39; (X&#39; X)^{-1} x_i}\]</p><p>And as per below when it is a weighted regression with a vector of weights <span>$W$</span> with the i-th weight being <span>$w_i$</span> then the i-th leverage is calculated as such:</p><p class="math-container">\[\mathrm{h_i} = \mathrm{w_i \cdot  x_i&#39; (X&#39; W X)^{-1} x_i}\]</p><h4 id="STDP"><a class="docs-heading-anchor" href="#STDP">STDP</a><a id="STDP-1"></a><a class="docs-heading-anchor-permalink" href="#STDP" title="Permalink"></a></h4><p>STDP is the standard error of the mean predicted value, and is calculated as </p><p class="math-container">\[\textup{STDP} = \sqrt{\hat{\sigma}^2 h_i }\]</p><p>and for a weighted regression as:</p><p class="math-container">\[\textup{STDP} = \sqrt{\hat{\sigma}^2 h_i  / w_i}\]</p><h4 id="STDI"><a class="docs-heading-anchor" href="#STDI">STDI</a><a id="STDI-1"></a><a class="docs-heading-anchor-permalink" href="#STDI" title="Permalink"></a></h4><p>STDI is the standard error of the individual predicted value, and is calculated as </p><p class="math-container">\[\textup{STDI} = \sqrt{\hat{\sigma}^2 (1 + h_i)}\]</p><p>and for a weighted regression as:</p><p class="math-container">\[\textup{STDI} = \sqrt{\hat{\sigma}^2 (1 + h_i) / w_i}\]</p><h4 id="STDR"><a class="docs-heading-anchor" href="#STDR">STDR</a><a id="STDR-1"></a><a class="docs-heading-anchor-permalink" href="#STDR" title="Permalink"></a></h4><p>STDR is the standard error of the residual, and is calculated as </p><p class="math-container">\[\textup{STDR} = \sqrt{\hat{\sigma}^2 (1 - h_i) }\]</p><p>and for a weighted regression as:</p><p class="math-container">\[\textup{STDR} = \sqrt{\hat{\sigma}^2 (1 - h_i) / w_i}\]</p><h4 id="Student"><a class="docs-heading-anchor" href="#Student">Student</a><a id="Student-1"></a><a class="docs-heading-anchor-permalink" href="#Student" title="Permalink"></a></h4><p>Student represents the standardized residuals, and is calculated by using the residuals over the standard error of the residuals.</p><h4 id="RStudent"><a class="docs-heading-anchor" href="#RStudent">RStudent</a><a id="RStudent-1"></a><a class="docs-heading-anchor-permalink" href="#RStudent" title="Permalink"></a></h4><p>RStudent is the studentized residuals calculated as</p><p class="math-container">\[\textup{RSTUDENT} = \sqrt{ \frac{n - p - 1}{n - p - \textup{student}^2}} \]</p><h4 id="LCLI"><a class="docs-heading-anchor" href="#LCLI">LCLI</a><a id="LCLI-1"></a><a class="docs-heading-anchor-permalink" href="#LCLI" title="Permalink"></a></h4><p>LCLI is the lower bound of the prediction interval and is calculated as:</p><p class="math-container">\[\textup{LCLI} = \mathrm{predicted} - ( \mathrm{t\_statistic} \cdot \mathrm{STDI} )\]</p><h4 id="UCLI"><a class="docs-heading-anchor" href="#UCLI">UCLI</a><a id="UCLI-1"></a><a class="docs-heading-anchor-permalink" href="#UCLI" title="Permalink"></a></h4><p>UCLI is the upper bound of the prediction interval and is calculated as:</p><p class="math-container">\[\textup{UCLI} = \mathrm{predicted} + ( \mathrm{t\_statistic} \cdot \mathrm{STDI} )\]</p><h4 id="LCLP"><a class="docs-heading-anchor" href="#LCLP">LCLP</a><a id="LCLP-1"></a><a class="docs-heading-anchor-permalink" href="#LCLP" title="Permalink"></a></h4><p>LCLP is the lower bound of the predicted mean confidence interval and is calculated as:</p><p class="math-container">\[\textup{LCLP} = \mathrm{predicted} - ( \mathrm{t\_statistic} \cdot \mathrm{STDP} )\]</p><h4 id="UCLP"><a class="docs-heading-anchor" href="#UCLP">UCLP</a><a id="UCLP-1"></a><a class="docs-heading-anchor-permalink" href="#UCLP" title="Permalink"></a></h4><p>UCLP is the upper bound of the predicted mean confidence interval and is calculated as:</p><p class="math-container">\[\textup{UCLI} = \mathrm{predicted} + ( \mathrm{t\_statistic} \cdot \mathrm{STDP} )\]</p><h4 id="COOKSD"><a class="docs-heading-anchor" href="#COOKSD">COOKSD</a><a id="COOKSD-1"></a><a class="docs-heading-anchor-permalink" href="#COOKSD" title="Permalink"></a></h4><p>COOKSD is the Cook&#39;s Distance for each predicted value, and is calculated as </p><p class="math-container">\[\textup{COOKSD} = \frac{1}{p} \frac{\textup{STDP}^2}{\textup{STDR}^2 \cdot \textup{student}^2}\]</p><h4 id="PRESS"><a class="docs-heading-anchor" href="#PRESS">PRESS</a><a id="PRESS-1"></a><a class="docs-heading-anchor-permalink" href="#PRESS" title="Permalink"></a></h4><p>PRESS is the predicted residual error sum of squares and is calculated as </p><p class="math-container">\[\textup{PRESS} = \frac{\textup{residuals}}{1 - \textup{leverage}}\]</p><h4 id="Weighted-regression"><a class="docs-heading-anchor" href="#Weighted-regression">Weighted regression</a><a id="Weighted-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Weighted-regression" title="Permalink"></a></h4><p>This version is the initial implementation of a weighted regression using analytical weights. Here is a minimal example illustrating its usage.</p><pre><code class="language-julia hljs">using LinearRegression, DataFrames, StatsModels
using Distributions # for the data generation with Normal() and Uniform()
using VegaLite

tw = [
    2.3  7.4  0.058
    3.0  7.6  0.073
    2.9  8.2  0.114
    4.8  9.0  0.144
    1.3 10.4  0.151
    3.6 11.7  0.119
    2.3 11.7  0.119
    4.6 11.8  0.114
    3.0 12.4  0.073
    5.4 12.9  0.035
    6.4 14.0  0
] # data from https://blogs.sas.com/content/iml/2016/10/05/weighted-regression.html

df = DataFrame(tw, [:y,:x,:w])
lm, ps= regress(@formula(y ~ x), df, &quot;fit&quot;, weights=&quot;w&quot;)
lm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Model definition:	y ~ 1 + x
Used observations:	10
Weighted regression
Model statistics:
  R²: 0.0149549			Adjusted R²: -0.108176
  MSE: 0.182858			RMSE: 0.427619
  σ̂²: 0.182858
Confidence interval: 95%

Coefficients statistics:
Terms ╲ Stats │     Coefs    Std err          t   Pr(&gt;|t|)     low ci    high ci
──────────────┼─────────────────────────────────────────────────────────────────
(Intercept)   │   2.32824    2.55186   0.912367   0.388242   -3.55637    8.21285
x             │ 0.0853571   0.244924   0.348505   0.736455  -0.479438   0.650152
</code></pre><p><img src="wls_fit_plot_doc.svg" alt/></p><h3 id="General-remarks"><a class="docs-heading-anchor" href="#General-remarks">General remarks</a><a id="General-remarks-1"></a><a class="docs-heading-anchor-permalink" href="#General-remarks" title="Permalink"></a></h3><p>For all options and parameters they can be passed as a <code>Vector{String}</code> or a <code>Vector{Symbol}</code> or alternatively if only options is needed as a single <code>String</code> or <code>Symbol</code>. For instance <code>&quot;all&quot;</code>, <code>:all</code> or <code>[&quot;R2&quot;, &quot;VIF&quot;]</code> or <code>[:r2, :vif]</code>. </p><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="LinearRegression.regress-Tuple{FormulaTerm, DataFrame, Any}" href="#LinearRegression.regress-Tuple{FormulaTerm, DataFrame, Any}"><code>LinearRegression.regress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function regress(f::StatsModels.FormulaTerm, df::DataFrames.DataFrame, req_plots; α::Float64=0.05, req_stats=[&quot;default&quot;],
weights::Union{Nothing,String}=nothing, remove_missing=false, cov=[:none], contrasts=nothing, 
plot_args=Dict(&quot;plot_width&quot; =&gt; 400, &quot;loess_bw&quot; =&gt; 0.6, &quot;residuals_with_density&quot; =&gt; false))

Estimate the coefficients of the regression, given a dataset and a formula. and provide the requested plot(s).
A dictionary of the generated plots indexed by the descritption of the plots.

It is possible to indicate the width of the plots, and the bandwidth of the Loess smoother.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericqu/LinearRegression.jl/blob/fd579c3f5e315b834b648dde396a5df66db3aa10/src/LinearRegression.jl#L238-L248">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearRegression.regress-Tuple{FormulaTerm, DataFrame}" href="#LinearRegression.regress-Tuple{FormulaTerm, DataFrame}"><code>LinearRegression.regress</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function regress(f::StatsModels.FormulaTerm, df::DataFrames.DataFrame; α::Float64=0.05, req_stats=[&quot;default&quot;], weights::Union{Nothing,String}=nothing,
remove_missing=false, cov=[:none], contrasts=nothing)

Estimate the coefficients of the regression, given a dataset and a formula. 

The formula details are provided in the StatsModels package and the behaviour aims to be similar as what the Julia GLM package provides.
The data shall be provided as a DataFrame without missing data.
If remove_missing is set to true a copy of the dataframe will be made and the row with missing data will be removed.
Some robust covariance estimator(s) can be requested through the ```cov``` argument.
Default contrast is dummy coding, other contrasts can be requested through the ```contrasts``` argument.
For a weighted regression, the name of column containing the analytical weights shall be identified by the ```weights``` argument.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericqu/LinearRegression.jl/blob/fd579c3f5e315b834b648dde396a5df66db3aa10/src/LinearRegression.jl#L280-L293">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearRegression.predict_in_sample-Tuple{linRegRes, DataFrame}" href="#LinearRegression.predict_in_sample-Tuple{linRegRes, DataFrame}"><code>LinearRegression.predict_in_sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">predict_in_sample(lr::linRegRes, df::DataFrames.DataFrame; α=0.05, req_stats=[&quot;none&quot;], dropmissingvalues=true)

Using the estimated coefficients from the regression make predictions, and calculate related statistics.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericqu/LinearRegression.jl/blob/fd579c3f5e315b834b648dde396a5df66db3aa10/src/LinearRegression.jl#L673-L677">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearRegression.predict_out_of_sample-Tuple{linRegRes, DataFrame}" href="#LinearRegression.predict_out_of_sample-Tuple{linRegRes, DataFrame}"><code>LinearRegression.predict_out_of_sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function predict_out_of_sample(lr::linRegRes, df::DataFrames.DataFrame; α=0.05, req_stats=[&quot;none&quot;], dropmissingvalues=true)

use the coefficients from a regression make predictions based on data (not including the response variable) from a DataFrame.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericqu/LinearRegression.jl/blob/fd579c3f5e315b834b648dde396a5df66db3aa10/src/LinearRegression.jl#L584-L588">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#LinearRegression.predict_in_sample-Tuple{linRegRes, DataFrame}"><code>LinearRegression.predict_in_sample</code></a></li><li><a href="#LinearRegression.predict_out_of_sample-Tuple{linRegRes, DataFrame}"><code>LinearRegression.predict_out_of_sample</code></a></li><li><a href="#LinearRegression.regress-Tuple{FormulaTerm, DataFrame}"><code>LinearRegression.regress</code></a></li><li><a href="#LinearRegression.regress-Tuple{FormulaTerm, DataFrame, Any}"><code>LinearRegression.regress</code></a></li></ul><h2 id="Content"><a class="docs-heading-anchor" href="#Content">Content</a><a id="Content-1"></a><a class="docs-heading-anchor-permalink" href="#Content" title="Permalink"></a></h2><ul><li class="no-marker"><ul><li><a href="basic_tutorial/#Tutorial-Linear-Regression-Basics">Tutorial Linear Regression Basics</a></li></ul></li><li><a href="#LinearRegression.jl-Documentation">LinearRegression.jl Documentation</a></li><li class="no-marker"><ul><li><a href="#Functions">Functions</a></li><li><a href="#Index">Index</a></li><li><a href="#Content">Content</a></li><li><a href="multi_tutorial/#Tutorial-multiple-linear-regression-with-categorical-variables">Tutorial multiple linear regression with categorical variables</a></li><li><a href="weighted_regression_tutorial/#Tutorial-weighted-regression">Tutorial weighted regression</a></li></ul></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="basic_tutorial/">Basic »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 12 November 2021 23:16">Friday 12 November 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
